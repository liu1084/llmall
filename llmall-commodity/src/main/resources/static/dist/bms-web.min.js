/**
 * Copyright 2018 上海际链 
 * 版权所有,请勿随意拷贝或者散布代码,公司有权追究保密协议中涉及的法律责任和条款.
**/
/*! 2018-03-27 */

!function(c,o){HandlebarsRender=function(){},HandlebarsRender.prototype={render:function(e,t,s,i){var n=c("body");n.find(".handlebars").remove(),n.append(e);var a=c(".handlebars").html(),r=o.compile(a)(t);c(s).html(r),i&&c.isFunction(i)&&i()}}}(jQuery,Handlebars),function(c){var e=function(){this.baseUrl=""};e.prototype={init:function(){this.getBaseUrl(),this.load(),this.bind()},getBaseUrl:function(){this.baseUrl=c("#baseURL").text()},bind:function(){var i=this;c(document).on("click","input.select-all",function(){i.selectAllBasicPrices(),c(".delete-selected").prop("disabled",!1)}),c(document).on("click","input.select-reverse",function(){i.selectReverseBasicPrices()}),c(document).on("change",".base-discount-select",function(){0<c("input.base-discount-select:checked").length?c(".delete-selected").prop("disabled",!1):c(".delete-selected").prop("disabled",!0)}),c(document).on("click",".new-base-discount",function(){i.createOrUpdate()}),c(document).on("click",".save-base-discount",function(){var e={businessType:c("select.business-type").val(),discount:c("#discount").val()?c("#discount").val():0};if(i.validDiscount(e)){var t=c(this).data("id");if(t)return e.id=t,i.updateBaseDiscountById(e),!1;i.saveBaseDiscount(e)}}),c(document).on("click",".base-discount-update",function(){var e=c(this).data("update-id");e&&i.getBaseDiscountById(e)}),c(document).on("click",".delete-selected",function(){var t=c("input.base-discount-select:checked");if(0<t.length){var e=i.baseUrl+"/price/deleteBaseDiscount",s=[];c.each(t,function(e,t){!0===c(t).prop("checked")&&s.push(c(t).val())}),c.ajax({url:e,type:"POST",data:JSON.stringify(s),contentType:"application/json",dataType:"JSON",success:function(e){i.showAlert("删除基础折扣率成功，共删除"+e+"记录."),c.each(t,function(e,t){c(t).parents("tr.price.base-discount").hide()}),i.load()},error:function(e){i.showAlert(e.responseText)}})}})},selectAllBasicPrices:function(){var e=c("input.base-discount-select");c.each(e,function(e,t){c(t).prop("checked",!0)})},selectReverseBasicPrices:function(){var e=c("input.base-discount-select");c.each(e,function(e,t){c(t).is(":checked")?c(t).prop("checked",!1):c(t).prop("checked",!0)}),0<c("input.base-discount-select:checked").length?c(".delete-selected").prop("disabled",!1):c(".delete-selected").prop("disabled",!0)},saveBaseDiscount:function(e){var t=this,s=t.baseUrl+"/price/saveBaseDiscount";c.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return c("#base-discount-new").modal("hide"),t.showAlert("基础折扣率增加成功"),t.load(),!1;t.showAlert("基础折扣率增加失败")},error:function(e){t.showAlert(e.responseText)}})},getBaseDiscountById:function(s){var i=this,e=i.baseUrl+"/price/getBaseDiscountById/"+s;c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t={selectedBusinessType:e.businessType,data:e};i.createOrUpdate(s,t)},error:function(e){i.showAlert(e.responseText)}})},updateBaseDiscountById:function(e){var t=this,s=t.baseUrl+"/price/updateBaseDiscountById";c.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return c("#base-discount-new").modal("hide"),t.showAlert("基础折扣率更新成功"),t.load(),!1;t.showAlert("基础折扣率更新失败")},error:function(e){t.showAlert(e.responseText)}})},validDiscount:function(e){return!0},createOrUpdate:function(s,i){var n=this,e=new HandlebarsRender,t=templates["src/templates/base-discount-new.hbs"],a=c(".dialog"),r=i?i.data:{};e.render(t,r,a,function(){c("#base-discount-new").modal("show");var e=c(".save-base-discount");if(e.data("id",""),s){e.data("id",s),e.text("修改"),c("#myModalLabel").text("修改基础折扣率");var t=i.selectedBusinessType;n.getBusinessTypes(t)}else c("#myModalLabel").text("新增基础折扣率"),n.getBusinessTypes()})},getBusinessTypes:function(a){var t=this,e=t.baseUrl+"/price/getBusinessTypes";c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/business-type.hbs"],i=c(".business-type-select"),n={businessTypes:e,selectedBusinessType:a};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},showAlert:function(e){var t=new HandlebarsRender,s=templates["src/templates/alert.hbs"],i=c(".alert-tip");t.render(s,e,i),c(i).show(),setTimeout(function(){c(i).hide()},3e3)},load:function(){var t=this,e=t.baseUrl+"/price/getAllBaseDiscount";c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){e=t.fixNumberPrecision(e),c(".base-discount-table").data("baseDiscount",e),t.loadBaseDiscount(e)},error:function(e){t.showAlert(e.responseText)}})},fixNumberPrecision:function(e,s){return s||(s=4),c.each(e,function(e,t){t.discount=parseFloat(t.discount).toFixed(s)}),e},loadBaseDiscount:function(e){var t=new HandlebarsRender,s=templates["src/templates/table-base-discount.hbs"],i=c("table.base-discount-table > tbody");t.render(s,e,i,function(){})}},window.Handlebars.registerHelper("selected",function(e,t){return e===t?" selected":""}),(new e).init()}(jQuery),function(o){var e=function(){this.baseUrl=""};e.prototype={init:function(){this.getBaseUrl(),this.load(),this.bind()},getBaseUrl:function(){this.baseUrl=o("#baseURL").text()},load:function(){var t=this,e=t.baseUrl+"/price/getAllBasePrices";o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){e=t.fixNumberPrecision(e),o(".basic-price-table").data("basicPrices",e),t.loadPrices(e)},error:function(e){t.showAlert(e.responseText)}})},loadPrices:function(e){var t=new HandlebarsRender,s=templates["src/templates/table-basic-price.hbs"],i=o("table.basic-price-table > tbody");t.render(s,e,i,function(){})},fixNumberPrecision:function(e,s){return s||(s=2),o.each(e,function(e,t){t.price=parseFloat(t.price).toFixed(s),t.minPrice=parseFloat(t.minPrice).toFixed(s),t.subPrice=parseFloat(t.subPrice).toFixed(s),t.subMinPrice=parseFloat(t.subMinPrice).toFixed(s)}),e},bind:function(){var i=this;o(document).on("click",".new-basic-price",function(){i.createOrUpdate()}),o(document).on("change",".bill-type",function(){var e=o(this).val();i.getBillItemByType(e)}),o(document).on("change",".basic-price-select",function(){0<o("input.basic-price-select:checked").length?o(".delete-selected").prop("disabled",!1):o(".delete-selected").prop("disabled",!0)}),o(document).on("click",".delete-selected",function(){var t=o("input.basic-price-select:checked");if(0<t.length){var e=i.baseUrl+"/price/deleteBasicPrices",s=[];o.each(t,function(e,t){!0===o(t).prop("checked")&&s.push(o(t).val())}),o.ajax({url:e,type:"POST",data:JSON.stringify(s),contentType:"application/json",dataType:"JSON",success:function(e){i.showAlert("删除基础价格成功，共删除"+e+"记录."),o.each(t,function(e,t){o(t).parents("tr.price.basic").hide()}),i.load()},error:function(e){i.showAlert(e.responseText)}})}}),o(document).on("click",".save-base-price",function(){var e={warehouseCode:o("#warehouseCode").val(),warehouseName:o("#warehouseName").val(),billType:o("select.bill-type").val(),billItem:o("select.bill-item").val(),unit:o("select.bill-unit").val(),price:o("#price").val()?o("#price").val():0,minPrice:o("#minPrice").val()?o("#minPrice").val():0,subPrice:o("#subPrice").val()?o("#subPrice").val():0,subMinPrice:o("#subMinPrice").val()?o("#subMinPrice").val():0,period:o("select.bill-period-select").val(),lat:o("select.bill-lat-select").val()};if(i.validBasicPrice(e)){var t=o(this).data("id");if(t)return e.id=t,i.updateBasePriceById(e),!1;i.saveBasePrice(e)}}),o(document).on("click",".price-basic-update",function(){var e=o(this).data("update-id");e&&i.getBasePriceById(e)}),o(document).on("focusout keyup","input.price-basic-search",function(){var e=o(this).val();i.filterBasicPrice(e)}),o(document).on("click","input.select-all",function(){i.selectAllBasicPrices(),o(".delete-selected").prop("disabled",!1)}),o(document).on("click","input.select-reverse",function(){i.selectReverseBasicPrices()})},filterBasicPrice:function(i){var e=o(".basic-price-table").data("basicPrices");if(i){if(e&&0<e.length){var t=o.grep(e,function(e,t){var s=new RegExp(i,"gi");return e.warehouseCode===i||e.warehouseName===i||s.test(e.warehouseCode)||s.test(e.warehouseName)});this.loadPrices(t)}}else this.loadPrices(e)},validBasicPrice:function(){return!0},selectAllBasicPrices:function(){var e=o("input.basic-price-select");o.each(e,function(e,t){o(t).prop("checked",!0)})},selectReverseBasicPrices:function(){var e=o("input.basic-price-select");o.each(e,function(e,t){o(t).is(":checked")?o(t).prop("checked",!1):o(t).prop("checked",!0)}),0<o("input.basic-price-select:checked").length?o(".delete-selected").prop("disabled",!1):o(".delete-selected").prop("disabled",!0)},createOrUpdate:function(a,r){var c=this,e=new HandlebarsRender,t=templates["src/templates/basic-price-new.hbs"],s=o(".dialog"),i=r?r.data:{};e.render(t,i,s,function(){o("#basic-price-new").modal("show");var e=o(".save-base-price");if(e.data("id",""),a){e.data("id",a),e.text("修改"),o("#myModalLabel").text("修改基础价格");var t=r.selectedBillType,s=r.selectedBillUnit,i=r.selectedBillPeriod,n=r.selectedBillLat;c.getBillType(t),c.getBillItemByType(t,r.selectedBillItem),c.getBillUnit(s),c.getBillPeriods(i),c.getBillLats(n)}else o("#myModalLabel").text("新增基础价格"),c.getBillType(),c.getBillItemByType(1e3,1001),c.getBillUnit(),c.getBillPeriods(),c.getBillLats()})},getBillType:function(a){var t=this,e=t.baseUrl+"/rule/getBillTypes";o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/bill-type.hbs"],i=o(".bill-type-select"),n={billTypes:e,selectedBillType:a};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},getBillItemByType:function(e,a){var t=this;if(e){var s=t.baseUrl+"/rule/getBillItemsByType/"+e;o.ajax({url:s,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/bill-item.hbs"],i=o(".bill-item-select"),n={selectedBillItem:a,billItems:e};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})}},getBillUnit:function(a){var t=this,e=t.baseUrl+"/rule/getBillUnits";o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/bill-unit.hbs"],i=o(".bill-unit-select"),n={billUnits:e,selectedBillUnit:a};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},getBillPeriods:function(a){var t=this,e=t.baseUrl+"/rule/getBillPeriods";o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/bill-period.hbs"],i=o(".bill-period-select"),n={billPeriods:e,selectedBillPeriod:a};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},getBillLats:function(a){var t=this,e=t.baseUrl+"/rule/getBillLats";o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/bill-lat.hbs"],i=o(".bill-lat-select"),n={selectedBillLat:a,billLats:e};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},saveBasePrice:function(e){var t=this,s=t.baseUrl+"/price/savePriceBase";o.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return o("#basic-price-new").modal("hide"),t.showAlert("基础价格增加成功"),t.load(),!1;t.showAlert("基础价格增加失败")},error:function(e){t.showAlert(e.responseText)}})},showAlert:function(e){var t=new HandlebarsRender,s=templates["src/templates/alert.hbs"],i=o(".alert-tip");t.render(s,e,i),o(i).show(),setTimeout(function(){o(i).hide()},3e3)},getBasePriceById:function(s){var i=this,e=i.baseUrl+"/price/getBasePriceById/"+s;o.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t={selectedBillType:e.billType,selectedBillItem:e.billItem,selectedBillUnit:e.unit,selectedBillPeriod:e.period,selectedBillLat:e.lat,data:e};i.createOrUpdate(s,t)},error:function(e){i.showAlert(e.responseText)}})},updateBasePriceById:function(e){var t=this,s=t.baseUrl+"/price/updateBasePriceById";o.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return o("#basic-price-new").modal("hide"),t.showAlert("基础价格更新成功"),t.load(),!1;t.showAlert("基础价格更新失败")},error:function(e){t.showAlert(e.responseText)}})},showDatePicker:function(){var e={format:"yyyy-mm-dd",autoclose:!0,language:"zh-CN"};o("#start-datetime").datepicker(e).datepicker("update",new Date),o("#end-datetime").datepicker(e).datepicker("update",new Date)}},window.Handlebars.registerHelper("selected",function(e,t){return e===t?" selected":""}),(new e).init()}(jQuery),function(c){var e=function(){this.baseUrl=""};e.prototype={init:function(){this.getBaseUrl(),this.load(),this.bind()},getBaseUrl:function(){this.baseUrl=c("#baseURL").text()},bind:function(){var i=this;c(document).on("click","input.select-all",function(){i.selectAllBasicPrices(),c(".delete-selected").prop("disabled",!1)}),c(document).on("click","input.select-reverse",function(){i.selectReverseBasicPrices()}),c(document).on("focusout keyup","input.business-discount-search",function(){var e=c(this).val();i.filterBusinessDiscount(e)}),c(document).on("change",".business-discount-select",function(){0<c("input.business-discount-select:checked").length?c(".delete-selected").prop("disabled",!1):c(".delete-selected").prop("disabled",!0)}),c(document).on("click",".new-business-discount",function(){i.createOrUpdate()}),c(document).on("click",".save-business-discount",function(){var e={businessType:c("select.business-type").val(),discount:c("#discount").val()?c("#discount").val():0,partnerCode:c("#partner-code").val(),partnerName:c("#partner-name").val()};if(i.validBusinessDiscount(e)){var t=c(this).data("id");if(t)return e.id=t,i.updateBusinessDiscountById(e),!1;i.saveBusinessDiscount(e)}}),c(document).on("click",".business-discount-update",function(){var e=c(this).data("update-id");e&&i.getBusinessDiscountById(e)}),c(document).on("click",".delete-selected",function(){var t=c("input.business-discount-select:checked");if(0<t.length){var e=i.baseUrl+"/price/deleteBusinessDiscount",s=[];c.each(t,function(e,t){!0===c(t).prop("checked")&&s.push(c(t).val())}),c.ajax({url:e,type:"POST",data:JSON.stringify(s),contentType:"application/json",dataType:"JSON",success:function(e){i.showAlert("删除特殊折扣率成功，共删除"+e+"记录."),c.each(t,function(e,t){c(t).parents("tr.price.business-discount").hide()}),i.load()},error:function(e){i.showAlert(e.responseText)}})}})},selectAllBasicPrices:function(){var e=c("input.business-discount-select");c.each(e,function(e,t){c(t).prop("checked",!0)})},selectReverseBasicPrices:function(){var e=c("input.business-discount-select");c.each(e,function(e,t){c(t).is(":checked")?c(t).prop("checked",!1):c(t).prop("checked",!0)}),0<c("input.business-discount-select:checked").length?c(".delete-selected").prop("disabled",!1):c(".delete-selected").prop("disabled",!0)},saveBusinessDiscount:function(e){var t=this,s=t.baseUrl+"/price/saveBusinessDiscount";c.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return c("#business-discount-new").modal("hide"),t.showAlert("特殊折扣率增加成功"),t.load(),!1;t.showAlert("特殊折扣率增加失败")},error:function(e){t.showAlert(e.responseText)}})},getBusinessDiscountById:function(s){var i=this,e=i.baseUrl+"/price/getBusinessDiscountById/"+s;c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t={selectedBusinessType:e.businessType,data:e};i.createOrUpdate(s,t)},error:function(e){i.showAlert(e.responseText)}})},updateBusinessDiscountById:function(e){var t=this,s=t.baseUrl+"/price/updateBusinessDiscountById";c.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return c("#business-discount-new").modal("hide"),t.showAlert("特殊折扣率更新成功"),t.load(),!1;t.showAlert("特殊折扣率更新失败")},error:function(e){t.showAlert(e.responseText)}})},validBusinessDiscount:function(e){return!0},createOrUpdate:function(s,i){var n=this,e=new HandlebarsRender,t=templates["src/templates/business-discount-new.hbs"],a=c(".dialog"),r=i?i.data:{};e.render(t,r,a,function(){c("#business-discount-new").modal("show");var e=c(".save-business-discount");if(e.data("id",""),s){e.data("id",s),e.text("修改"),c("#myModalLabel").text("修改特殊折扣率");var t=i.selectedBusinessType;n.getBusinessTypes(t)}else c("#myModalLabel").text("新增特殊折扣率"),n.getBusinessTypes()})},getBusinessTypes:function(a){var t=this,e=t.baseUrl+"/price/getBusinessTypes";c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t=new HandlebarsRender,s=templates["src/templates/business-type.hbs"],i=c(".business-type-select"),n={businessTypes:e,selectedBusinessType:a};t.render(s,n,i,function(){})},error:function(e){t.showAlert(e.responseText)}})},filterBusinessDiscount:function(i){var e=c(".business-discount-table").data("businessDiscount");if(i){if(e&&0<e.length){var t=c.grep(e,function(e,t){var s=new RegExp(i,"gi");return e.partnerCode===i||e.partnerName===i||s.test(e.partnerCode)||s.test(e.partnerName)});this.loadBusinessDiscount(t)}}else this.loadBusinessDiscount(e)},showAlert:function(e){var t=new HandlebarsRender,s=templates["src/templates/alert.hbs"],i=c(".alert-tip");t.render(s,e,i),c(i).show(),setTimeout(function(){c(i).hide()},3e3)},load:function(){var t=this,e=t.baseUrl+"/price/getAllBusinessDiscounts";c.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){e=t.fixNumberPrecision(e),c(".business-discount-table").data("businessDiscount",e),t.loadBusinessDiscount(e)},error:function(e){t.showAlert(e.responseText)}})},fixNumberPrecision:function(e,s){return s||(s=4),c.each(e,function(e,t){t.discount=parseFloat(t.discount).toFixed(s)}),e},loadBusinessDiscount:function(e){var t=new HandlebarsRender,s=templates["src/templates/table-business-discount.hbs"],i=c("table.business-discount-table > tbody");t.render(s,e,i,function(){})}},window.Handlebars.registerHelper("selected",function(e,t){return e===t?" selected":""}),(new e).init()}(jQuery),function(r){var e=function(){this.baseUrl=""};e.prototype={init:function(){this.load(),this.bind()},getBaseUrl:function(){this.baseUrl=r("#baseURL").text()},bind:function(){var i=this;r(document).on("click","input.select-all",function(){i.selectAllProviderBaseRadio(),r(".delete-selected").prop("disabled",!1)}),r(document).on("click","input.select-reverse",function(){i.selectReverseProviderBaseRadio()}),r(document).on("focusout keyup","input.provider-base-radio-search",function(){var e=r(this).val();i.filterProviderBaseRadio(e)}),r(document).on("change","input.provider-radio-select",function(){0<r("input.provider-radio-select:checked").length?r(".delete-selected").prop("disabled",!1):r(".delete-selected").prop("disabled",!0)}),r(document).on("click",".new-provider-base-radio",function(){i.createOrUpdate()}),r(document).on("click",".save-provider-base-radio",function(){var e={providerCode:r("#provider-code").val(),providerName:r("#provider-name").val(),radio:r("#radio").val()?r("#radio").val():0};if(i.validDiscount(e)){var t=r(this).data("id");if(t)return e.id=t,i.updateProviderBaseRadioById(e),!1;i.checkProviderExisted(e)}}),r(document).on("click",".provider-radio-update",function(){var e=r(this).data("update-id");e&&i.getProviderBaseRadioById(e)}),r(document).on("click",".delete-selected",function(){var t=r("input.provider-radio-select:checked");if(0<t.length){var e=i.baseUrl+"/provider/deletePriceProviderRadios",s=[];r.each(t,function(e,t){!0===r(t).prop("checked")&&s.push(r(t).val())}),r.ajax({url:e,type:"POST",data:JSON.stringify(s),contentType:"application/json",dataType:"JSON",success:function(e){i.showAlert("删除代理商抽成比例成功，共删除"+e+"记录."),r.each(t,function(e,t){r(t).parents("tr.provider.provider-radio").hide()}),i.load()},error:function(e){i.showAlert(e.responseText)}})}})},filterProviderBaseRadio:function(i){var e=r(".provider-base-radio-table").data("providerBaseRadio");if(i){if(e&&0<e.length){var t=r.grep(e,function(e,t){var s=new RegExp(i,"gi");return e.providerCode===i||e.providerName===i||s.test(e.providerCode)||s.test(e.providerName)});this.loadProviderBaseRadio(t)}}else this.loadProviderBaseRadio(e)},selectAllProviderBaseRadio:function(){var e=r("input.provider-radio-select");r.each(e,function(e,t){r(t).prop("checked",!0)})},selectReverseProviderBaseRadio:function(){var e=r("input.provider-radio-select");r.each(e,function(e,t){r(t).is(":checked")?r(t).prop("checked",!1):r(t).prop("checked",!0)}),0<r("input.provider-radio-select:checked").length?r(".delete-selected").prop("disabled",!1):r(".delete-selected").prop("disabled",!0)},checkProviderExisted:function(t){var s=this,e=t.providerCode,i=s.baseUrl+"/provider/checkProviderExisted/"+e;r.ajax({url:i,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){if(0<e)return s.showAlert("代理商编码已经存在，无法继续添加"),!1;s.saveProviderBaseRadio(t)},error:function(e){s.showAlert(e.responseText)}})},saveProviderBaseRadio:function(e){var t=this,s=t.baseUrl+"/provider/saveProviderBaseRadio";r.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return r("#provider-base-radio-new").modal("hide"),t.showAlert("代理商抽成比例增加成功"),t.load(),!1;t.showAlert("代理商抽成比例增加失败")},error:function(e){t.showAlert(e.responseText)}})},getProviderBaseRadioById:function(s){var i=this,e=i.baseUrl+"/provider/getProviderBaseRadioById/"+s;r.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){var t={data:e};i.createOrUpdate(s,t)},error:function(e){i.showAlert(e.responseText)}})},updateProviderBaseRadioById:function(e){var t=this,s=t.baseUrl+"/provider/updateProviderBaseRadioById";r.ajax({url:s,type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"JSON",success:function(e){if(1===e)return r("#provider-base-radio-new").modal("hide"),t.showAlert("代理商抽成比例更新成功"),t.load(),!1;t.showAlert("代理商抽成比例更新失败")},error:function(e){t.showAlert(e.responseText)}})},validDiscount:function(e){var t=new RegExp("^(\\d+\\.\\d{0,4}|1)$"),s=new RegExp("[0-9a-z_]+","i"),i=new RegExp("[0-9a-z_|\\u4e00-\\u9fa5]+","i"),n=e.radio,a=e.providerCode,r=e.providerName;return n&&!isNaN(n)&&a&&r?!t.test(n)||n<=0||1<n?(this.showAlert("代理商抽成比例不正确"),!1):s.test(a)?!!i.test(r)||(this.showAlert("代理商名称只能是0-9或者英文字母或者中文字符"),!1):(this.showAlert("代理商编码只能是0-9或者英文字母"),!1):(this.showAlert("radio只能输入0～1的数值，代理商编码只能输入0-9或者英文字母，代理商名称只能是0-9或者英文字母或者中文字符"),!1)},createOrUpdate:function(t,e){var s=new HandlebarsRender,i=templates["src/templates/provider-base-radio-new.hbs"],n=r(".dialog"),a=e?e.data:{};s.render(i,a,n,function(){r("#provider-base-radio-new").modal("show");var e=r(".save-provider-base-radio");e.data("id",""),t?(r("#provider-code").prop("disabled",!0),r("#provider-name").prop("disabled",!0),e.data("id",t),e.text("修改"),r("#myModalLabel").text("修改代理商抽成比例")):r("#myModalLabel").text("新增代理商抽成比例")})},showAlert:function(e){var t=new HandlebarsRender,s=templates["src/templates/alert.hbs"],i=r(".alert-tip");t.render(s,e,i),r(i).show(),setTimeout(function(){r(i).hide()},3e3)},load:function(){var t=this,e=t.baseUrl+"/provider/getAllProviderBaseRadios";r.ajax({url:e,type:"GET",contentType:"application/json",dataType:"JSON",success:function(e){e=t.fixNumberPrecision(e),r(".provider-base-radio-table").data("providerBaseRadio",e),t.loadProviderBaseRadio(e)},error:function(e){t.showAlert(e.responseText)}})},fixNumberPrecision:function(e,s){return s||(s=4),r.each(e,function(e,t){t.radio=parseFloat(t.radio).toFixed(s)}),e},loadProviderBaseRadio:function(e){var t=new HandlebarsRender,s=templates["src/templates/table-provider-base-radio.hbs"],i=r("table.provider-base-radio-table > tbody");t.render(s,e,i,function(){})}},window.Handlebars.registerHelper("selected",function(e,t){return e===t?" selected":""}),(new e).init()}(jQuery);
//# sourceMappingURL=bms-web.map